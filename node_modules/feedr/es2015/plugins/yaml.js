'use strict';

module.exports.parse = function parseYAML(_ref, next) {
	var feed = _ref.feed;
	var response = _ref.response;
	var data = _ref.data;

	// Detect
	var isYAML = feed.parse === 'yaml' || ['.yml', '.yaml'].indexOf(feed.extension) !== -1 || response.headers['content-type'].indexOf('yaml') !== -1;
	if (!isYAML) {
		next();
		return;
	}

	// Parse
	try {
		data = require('js-yaml').load(data.toString().trim());
	} catch (err) {
		next(err);
		return;
	}

	// Write
	next(null, data);
};